#include <iostream>
#include <Windows.h>
#include <tchar.h>

using namespace std;


int main()
{
    LONG lReg;
    HKEY hKey;
    DWORD dwData = 1;
    lReg = RegCreateKeyEx(
        HKEY_LOCAL_MACHINE,
        _T("SOFTWARE\\Policies\\Microsoft\\Windows Defender"),
        0,
        NULL,
        REG_OPTION_NON_VOLATILE,
        KEY_ALL_ACCESS | KEY_WOW64_64KEY,
        NULL,
        &hKey,
        NULL);
    if (lReg != ERROR_SUCCESS)
    {
        cout << "Registry creation failed & Error No - " << GetLastError() << endl;
    }
    cout << "Regsitry creation Success" << endl;

    lReg = RegSetValueEx(
        hKey,
        _T("DisableAntiSpyware"),
        NULL,
        REG_DWORD,
        (LPBYTE)&dwData,
        sizeof(DWORD)
        );
    if (lReg != ERROR_SUCCESS)
    {
        cout << "Registry value creation failed & Error No - " << GetLastError() << endl;
    }


    RegCloseKey(hKey);

    system("PAUSE");
    return 0;

}
